# @package _global_
# High-throughput preset for single RTX GPU + high-core-count CPU hosts (e.g., 128-core EPYC)
general:
  name: 'plinder-epyc-rtx'
  gpus: 1
  wandb: 'online'
  trainer_precision: bf16-mixed
  accumulate_grad_batches: 2
  torch_matmul_precision: high
  use_torch_compile: true
  cudnn_benchmark: true
  deterministic: false

train:
  # Keep base batch conservative for broad RTX compatibility; increase if VRAM allows.
  batch_size: 256
  reference_batch_size: 256
  num_workers: 96
  prefetch_factor: 4

model:
  use_pocket_interaction: true

dataset:
  name: 'plinder'
  pin_memory: true
  use_sample_cache: true
  sample_cache_version: 'epyc-rtx-v1'
  statistics_max_samples: 2000
  statistics_num_workers: 64
  statistics_batch_size: 128